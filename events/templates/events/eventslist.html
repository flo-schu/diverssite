{% extends "page/base_generic.html" %}
{% block content %}

<style>
.d-flex.w-100.justify-content-between{
 background-color: inherit;
 border-bottom: 1px solid gray;
}
.fixed-bottom{
  margin-bottom: 50px;
}

.container-fluid{
  padding-bottom: 50px;
}
</style>


<div class="row-fluid">
  {% for post in posts %}
  <div class="container">

    <h2>{{ post.title }}</h2>

    <p>{{ post.text }}</p>
  </div><!--/span-->
  {% endfor %}

</div><!--/row-->



<form action="{% url 'events:index' %}" method="post" name="participation">
  {% csrf_token %}
  <div class="container-fluid">
    <div class="fixed-bottom">
      <button class="btn btn-primary w-100" type="submit">save</button>
    </div>
    <div class="accordion" id="eventslist">
      {% for event, content in events.items %}
      <div class="card">
        <div class="card-header" id="{{event}}_heading">
          <a class="mb-0 d-flex">
            <div class="p-1 w-50">
              {{content.event.name}}
              {% if content.event.category == "training" %}
              <span class="badge badge-warning">{{content.event.category}}</span>
              {% elif content.event.category == "tournament" %}
              <span class="badge badge-success">{{content.event.category}}</span>
              {% elif content.event.category == "social" %}
              <span class="badge badge-primary">{{content.event.category}}</span>
              {% else %}
              <span class="badge badge-secondary">{{content.event.category}}</span>
              {% endif %}
              <br>
              <small>
                {{content.event.date}}
              </small>
            </div>
            <div class="">
              <span class="badge badge-primary badge-pill p-1 flex-shrink-1"> {{content.participation_count}} </span>
            </div>
            <div class="btn-group btn-group-toggle p-1 ml-auto" data-toggle="buttons">
              {% for choice_short, choice in content.choices.items %}
              <label class="btn btn-secondary">
                {% if choice.userchoice == choice.choicetext %}
                <input type="radio" name="evlist_{{user}}_{{content.event.id}}"
                id="{{choice.choice}}" value="{{choice_short}}" checked> {{choice.choicetext}}
                {% else %}
                <input type="radio" name="evlist_{{user}}_{{content.event.id}}"
                id="{{choice.choice}}" value="{{choice_short}}"> {{choice.choicetext}}
                {% endif %}
              </label>
              {% endfor %}
            </div>
            <small class="p-1">
              <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#list-{{event}}" aria-expanded="false" aria-controls="{{event}}">
                details
              </button>
            </small>
          <a>
        </div>

        <div class="collapse" id="list-{{event}}" aria-labelledby="{{event}}_heading" data-parent="#eventslist">
          <div class="card-body d-flex w-100 justify-content-between">
            <small>
              {{content.event.location.name}},
              {{content.event.location.street}},
              {{content.event.location.place}}
            </small>
            <p class="mt-2">
              {{content.event.description}}
            </p>
            {% if user.is_staff %}
            <a class="btn btn-light" role="button" href="{% url 'admin:events_event_change' content.event.id %}?next={{request.path}}">
              edit event
            </a>
            {% endif %}
          </div>


        </div>
      </div>
      {% endfor %}
    </div>
  </div>
</form>
{% endblock %}
